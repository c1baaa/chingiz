from pytube import YouTube
import os
from aiogram import Bot,Dispatcher,executor,types

TOKEN = '5006186670:AAFx7tLEL9LWZUfqgN0ICu7BIvTtdTTZOQo'

bot=Bot(TOKEN)
dp=Dispatcher(bot)
@dp.message_handler(commands=['start'])
async def start(message:types.Message):
    await bot.send_message(message.from_user.id,text='Send me your youtube video link')
@dp.message_handler()
async def image(message:types.Message):
   
    if message.text.startswith('https://www.youtube.com/'):
        link=message.text
        yt=YouTube(link)
        yt.streams.filter(progressive=True, file_extension="mp4").first().download()

        photo=f'{yt.thumbnail_url}'
        x=str(yt.streams.filter().first().default_filename).replace('3gpp','mp4')
        video=open(f'{x}','rb')
        
        await bot.send_photo(message.from_user.id,photo=photo)
        
        await bot.send_message(message.from_user.id,text=f'Channel name: {yt.author}\nDescription: {yt.description}')
        await bot.send_video(message.from_user.id,video=video)
        
        await bot.send_message(message.from_user.id,text=f'Completed âœ…')
        os.remove(str(yt.streams.filter().first().default_filename).replace('3gpp','mp4'))
if __name__=='__main__':
    executor.start_polling(dp,skip_updates=True)
